@model GymManagementSystem.Models.KhuyenMai
@using GymManagementSystem.Helpers
@{ 
    var culture = new System.Globalization.CultureInfo("vi-VN");
    var dbContext = new GymManagementSystem.Models.ApplicationDbContext();
    var quyTacInfo = KhuyenMaiHelper.SuyLuanQuyTacApDung(Model, dbContext);
}

<h4>Chi tiết: @Model.TenKhuyenMai</h4>

<dl>
    <dt class="text-muted">Mô Tả</dt>
    <dd class="mb-3">@Html.DisplayFor(model => model.MoTa)</dd>

    <dt class="text-muted">Mã Khuyến Mãi</dt>
    <dd class="mb-3">@Html.DisplayFor(model => model.MaKhuyenMai)</dd>

    <dt class="text-muted">Giảm Giá</dt>
    <dd class="mb-3">
        Giảm @Model.PhanTramGiamGia%
        @if (Model.SoTienGiamToiDa > 0)
        {
            <span>(tối đa @Model.SoTienGiamToiDa.ToString("N0", culture) đ)</span>
        }
    </dd>

    <dt class="text-muted">Thời Hạn Sử Dụng</dt>
    <dd class="mb-3">@Model.SoNgayHieuLuc ngày</dd>

    <dt class="text-muted">Quy Tắc Áp Dụng</dt>
    <dd class="mb-3">@quyTacInfo.TenQuyTac</dd>

    @if (quyTacInfo.DanhSachGoiTapLienQuan != null)
    {
        <dt class="text-muted">Danh sách Gói Tập Liên Quan</dt>
        <dd class="mb-3">
            <ul>
                @foreach (var goiTap in quyTacInfo.DanhSachGoiTapLienQuan)
                {
                    <li>@goiTap.TenGoi</li>
                }
            </ul>
        </dd>
    }

    <dt class="text-muted">Trạng Thái</dt>
    <dd>
        @if (Model.IsActive)
        {<span class="status-badge status-active">Kích hoạt</span> }
        else
        { <span class="status-badge status-inactive">Vô hiệu hóa</span>}
    </dd>
</dl>

<div class="offcanvas-footer">
    <button type="button" class="btn btn-offcanvas-secondary" data-bs-dismiss="offcanvas">Đóng</button>
</div>