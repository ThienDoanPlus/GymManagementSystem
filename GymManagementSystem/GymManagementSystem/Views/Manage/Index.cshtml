@model GymManagementSystem.Models.ViewModels.UserProfileViewModel
@{
    ViewBag.Title = "Bảng điều khiển";
}
<link href="@Url.Content("~/Content/Manage/profile.css")" rel="stylesheet" type="text/css" />

<!-- ======================================================== -->
<!-- CONTAINER CHÍNH CHO TOÀN BỘ DASHBOARD -->
<!-- ======================================================== -->
<div class="profile-dashboard-wrapper">

    <div class="profile-header">
        <img src="https://i.pravatar.cc/80" alt="Avatar" class="profile-avatar" />
        <div class="profile-info">
            <h3>@Model.UserName</h3>
            <p>@Model.Email</p>
        </div>
        @Html.ActionLink("Chỉnh sửa thông tin", "Edit", "Manage", null, new { @class = "btn-edit-profile" })
    </div>

    <div class="row">
        <!-- NỀN HIỆU ỨNG BONG BÓNG NỔI -->
        <ul class="background-bubbles">
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ul>

        <!-- Cột chính bên trái -->
        <div class="col-lg-8">
            <div class="membership-card">
                @if (Model.MembershipInfo.HangHienTai != null)
                {
                    <span class="unlocked-badge">@Model.MembershipInfo.HangHienTai.TenHang</span>
                    <div class="tier-progress">
                        <div>
                            <h3 class="tier-name">@Model.MembershipInfo.HangHienTai.TenHang Member</h3>
                            <p class="text-muted">Điểm tích lũy: @String.Format("{0:N0}", Model.MembershipInfo.TongChiTieu) / @String.Format("{0:N0}", Model.MembershipInfo.HangTiepTheo?.NguongChiTieu ?? Model.MembershipInfo.TongChiTieu)</p>
                            <div class="progress-bar-custom">
                                <div class="progress" style="width: @Model.MembershipInfo.PhanTramHoanThanh%;"></div>
                            </div>
                        </div>
                        @if (Model.MembershipInfo.HangTiepTheo != null)
                        {
                            <button class="btn-upgrade">Nâng cấp</button>
                        }
                    </div>
                }
                else
                {
                    <h3 class="tier-name">New Member</h3>
                }
            </div>

            <div class="member-benefits">
                <h4>Đặc quyền của bạn</h4>
                <div class="benefits-grid">
                    <div class="benefit-item"><i class="fas fa-bed"></i><p>Room Upgrade</p></div>
                    <div class="benefit-item"><i class="fas fa-birthday-cake"></i><p>Birthday Bonus</p></div>
                    <div class="benefit-item"><i class="fas fa-percent"></i><p>Partner Discounts</p></div>
                    <div class="benefit-item"><i class="fas fa-utensils"></i><p>Sunrise Feast</p></div>
                    <div class="benefit-item"><i class="fas fa-box-open"></i><p>Special Package</p></div>
                </div>
            </div>
        </div>

        <!-- Cột phụ bên phải -->
        <div class="col-lg-4">
            <div class="side-card invite-card">
                <h4>Mời bạn bè</h4>
                <p class="text-muted">Mã giới thiệu của bạn: <strong class="text-white">@Model.MaGioiThieu</strong></p>
                <p>Danh sách đã mời (@Model.ReferralInfo.DanhSachNguoiDuocGioiThieu.Count()):</p>
                <div class="buddies-list">
                    @foreach (var buddy in Model.ReferralInfo.DanhSachNguoiDuocGioiThieu.Take(5))
                    {
                        <div class="buddy-item">
                            <img src="https://i.pravatar.cc/60?u=@buddy.Email" alt="@buddy.HoTen" />
                            <p>@buddy.HoTen.Split(' ').FirstOrDefault()</p>
                        </div>
                    }
                </div>
            </div>

            <div class="side-card qr-code-card">
                <h4>Mã QR Check-in</h4>
                <p class="text-muted">Đưa mã này cho nhân viên để vào phòng tập.</p>
                <div class="text-center">
                    <img src="@Model.QrCodeUri" alt="Mã QR" style="width: 100%; border-radius: 12px;" />
                </div>
            </div>
        </div>
    </div>
</div>